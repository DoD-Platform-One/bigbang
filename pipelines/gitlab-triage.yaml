image: registry1.dso.mil/ironbank/opensource/gitlab-triage/gitlab-triage:1.23.1

# Include templates
include:
  - local: '/library/templates.yaml'

stages:
  - dry_run
  - scheduled

before_script:
  - gitlab-triage --version  # For debugging
  - curl -L https://repo1.dso.mil/big-bang/pipeline-templates/pipeline-templates/-/raw/master/library/templates.sh -o templates.sh
  - source ./templates.sh

gitlab-triage:
  stage: dry_run
  extends:
    - .generic-runner-tags
  except:
    - schedules
  script:
    - gitlab_triage_dryrun

gitlab-triage:on-schedule:
  stage: scheduled
  only:
    - schedules
  extends:
    - .generic-runner-tags
  script:
    - gitlab_triage
