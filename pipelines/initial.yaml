# global rules for when pipelines run
workflow:
  rules:
    # skip pipeline for MRs with docs label
    - if: $CI_MERGE_REQUEST_LABELS =~ /(^|,)kind::docs(,|$)/
      when: never
    # skip pipeline for MRs with disable-ci label
    - if: $CI_MERGE_REQUEST_LABELS =~ /(^|,)disable-ci(,|$)/
      when: never
    # run pipeline for manual tag events
    - if: $CI_COMMIT_TAG
    # run pipeline on merge request events
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
    # run pipeline on commits to default branch
    - if: $CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH

# Include templates and cluster creation jobs
include:
  - local: '/library/templates.yaml'

stages:
  - init

init:
  stage: init
  extends:
    - .generic-runner-tags
    - .util-image
    - .templates
  rules:
    - if: $INIT_PIPELINE != "true"
      when: never
  script:
    - echo init
